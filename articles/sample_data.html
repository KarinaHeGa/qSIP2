<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sample Data • qSIP2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">qSIP2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.19.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/qSIP_workflow.html">Standard qSIP EAF Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/filtering.html">Filtering Features</a></li>
    <li><a class="dropdown-item" href="../articles/resampling.html">Resampling</a></li>
    <li><a class="dropdown-item" href="../articles/EAF.html">EAF Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/growth.html">Growth Workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jeffkimbrel/qSIP2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sample Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jeffkimbrel/qSIP2/blob/master/vignettes/sample_data.Rmd" class="external-link"><code>vignettes/sample_data.Rmd</code></a></small>
      <div class="d-none name"><code>sample_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeffkimbrel/qSIP2" class="external-link">qSIP2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"qSIP2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] '0.19.1'</span></span></code></pre></div>
<div class="section level2">
<h2 id="samples-and-metadata">Samples and Metadata<a class="anchor" aria-label="anchor" href="#samples-and-metadata"></a>
</h2>
<p>In <code>qSIP2</code>, “sample data” refers to any metadata
associated with the individual fractions or their sequencing data. This
is the second level of metadata - more granular than “source data”, but
at a higher-level than the “feature data”.</p>
<div class="alert alert-primary">
<p>The word <strong>sample</strong> typically refers to the biological
or environmental entity the DNA was isolated (aka the <strong>source
material</strong>). In qSIP, however, because there are multiple
sequencing runs per <strong>source</strong>, the term
<strong>sample</strong> has historically been reserved for sequencing of
each fraction. In practice, this means you will have many
<strong>samples</strong> for each single <strong>source</strong>. To
keep with the proposed MISIP<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://www.biorxiv.org/content/10.1101/2023.07.13.548835v1" class="external-link uri"&gt;https://www.biorxiv.org/content/10.1101/2023.07.13.548835v1&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> standards, the source material is coded
with the <code>source_mat_id</code>, and each sequencing run/fraction is
coded with the <code>sample_id</code>.</p>
</div>
<p>The sample data has the most requirements to pass validation of the
three <code>qSIP2</code> input types. To standardize these requirements
the column names should adhere as closely to MISIP standards where
possible. Absolute requirements are slightly different than the official
MISIP standards, and for the <code>qSIP2</code> package would be the
<code>source_mat_id</code>, <code>sample_id</code>,
<code>gradient_position</code>, <code>gradient_pos_density</code> and
<code>gradient_pos_rel_amt</code> fields.</p>
<div class="section level3">
<h3 id="source_mat_id-and-sample_id-columns">
<code>source_mat_id</code> and <code>sample_id</code> columns<a class="anchor" aria-label="anchor" href="#source_mat_id-and-sample_id-columns"></a>
</h3>
<p>One column of the metadata should contain a unique
<code>sample_id</code> that is associated with a
<code>source_mat_id</code> that matches one row on the
<code>qsip_source_data</code> dataframe. Although the
<code>sample_id</code> should be unique for each row, it is expected
that the <code>source_mat_id</code> will be duplicated creating a
<strong>many-to-one</strong> relationship. The format of the
<code>sample_id</code> doesn’t matter, as long as it is unique. A
popular choice might be the <code>source_mat_id</code> appended with the
gradient position.</p>
</div>
<div class="section level3">
<h3 id="gradient_position-and-gradient_pos_density-columns">
<code>gradient_position</code> and <code>gradient_pos_density</code>
columns<a class="anchor" aria-label="anchor" href="#gradient_position-and-gradient_pos_density-columns"></a>
</h3>
<p>These are the required columns to describe the position and density
values for each <code>sample_id</code>. <code>gradient_position</code>
is typically numbered by decreasing density, so the heaviest will be
<code>1</code>, second heaviest will be <code>2</code>, etc. To pass
<code>qSIP2</code> validation the <code>gradient_position</code> must be
a positive integer, but <code>-1</code> will also be accepted to
designate a “bulk” or other “unfractionated” sample (e.g. when doing
growth analysis). <code>gradient_position</code> is not used directly in
<code>qSIP2</code> calculations but can be useful for quality control.
<code>gradient_pos_density</code> is reported as g/ml with as much
decimal place precision as your method allows.</p>
</div>
<div class="section level3">
<h3 id="gradient_pos_amt-and-gradient_pos_rel_amt-columns">
<code>gradient_pos_amt</code> and <code>gradient_pos_rel_amt</code>
columns<a class="anchor" aria-label="anchor" href="#gradient_pos_amt-and-gradient_pos_rel_amt-columns"></a>
</h3>
<p>A requirement for qSIP is the <code>gradient_pos_rel_amt</code>
field, which gives the percent amount that a fraction has of the whole.
The preferred method is given in qPCR copy numbers per volume of source
material, but DNA totals/concentrations can be used as well.</p>
<p>The <code>gradient_pos_rel_amt</code> column is required for MISIP
standards, but for <code>qSIP2</code> we also require an additional
<code>gradient_pos_amt</code> column with the “raw” abundance values for
each sample. This requirement is because typically a qSIP workflow will
produce the <code>gradient_pos_amt</code> values, and the
<code>gradient_pos_rel_amt</code> can be derived from it using the
<code><a href="../reference/add_gradient_pos_rel_amt.html">add_gradient_pos_rel_amt()</a></code> function. This function simply
totals up the <code>gradient_pos_amt</code> for each sample in a source,
and then divides by the total. This math is the same whether using qPCR
amplicon copies or total DNA isolated.</p>
<p>For example, if there are 100,000 total 16S copies in a source as
determined by qPCR, and 15,000 copies in fraction 7, then the
<code>gradient_pos_rel_amt</code> value for fraction 7 would be 0.15
(15,000 / 100,000). Similarly, if you had 25ng total DNA used for
density separation, and fraction 7 had 3.75 ng DNA recovered, then
<code>gradient_pos_rel_amt</code> would also be 0.15 (3.75 / 25).</p>
<p>See below for cases where it might make sense for the totals to not
add up to 100%, and how to work with those cases in
<code>qSIP2</code>.</p>
<p>An example sample dataframe is included in the <code>qSIP2</code>
package to demonstrate the possible columns.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_sample_df</span></span></code></pre></div>
<table class="table">
<caption>First few rows of formatted sample data</caption>
<thead><tr class="header">
<th align="left">sample</th>
<th align="left">source</th>
<th align="right">Fraction</th>
<th align="right">density_g_ml</th>
<th align="right">dna_conc</th>
<th align="right">avg_16S_g_soil</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">149_F1</td>
<td align="left">S149</td>
<td align="right">1</td>
<td align="right">1.778855</td>
<td align="right">0.0000000</td>
<td align="right">4473.7081</td>
</tr>
<tr class="even">
<td align="left">149_F2</td>
<td align="left">S149</td>
<td align="right">2</td>
<td align="right">1.773391</td>
<td align="right">0.0000000</td>
<td align="right">986.6581</td>
</tr>
<tr class="odd">
<td align="left">149_F3</td>
<td align="left">S149</td>
<td align="right">3</td>
<td align="right">1.765742</td>
<td align="right">0.0000000</td>
<td align="right">4002.7026</td>
</tr>
<tr class="even">
<td align="left">149_F4</td>
<td align="left">S149</td>
<td align="right">4</td>
<td align="right">1.759185</td>
<td align="right">0.0000000</td>
<td align="right">3959.7283</td>
</tr>
<tr class="odd">
<td align="left">149_F5</td>
<td align="left">S149</td>
<td align="right">5</td>
<td align="right">1.752629</td>
<td align="right">0.0012413</td>
<td align="right">5725.7319</td>
</tr>
<tr class="even">
<td align="left">149_F6</td>
<td align="left">S149</td>
<td align="right">6</td>
<td align="right">1.746072</td>
<td align="right">0.0128156</td>
<td align="right">7566.2722</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="qsip2-sample-data-object">qSIP2 Sample Data Object<a class="anchor" aria-label="anchor" href="#qsip2-sample-data-object"></a>
</h2>
<p>The <code><a href="../reference/qsip_sample_data.html">qsip_sample_data()</a></code> constructor builds a sample data
object from the dataframe. Like the source data object, the sample data
object is built by providing column names to the appropriate
parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qsip_sample_data.html">qsip_sample_data</a></span><span class="op">(</span><span class="va">example_sample_df</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>  source_mat_id <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  gradient_position <span class="op">=</span> <span class="st">"Fraction"</span>,</span>
<span>  gradient_pos_density <span class="op">=</span> <span class="st">"density_g_ml"</span>,</span>
<span>  gradient_pos_amt <span class="op">=</span> <span class="st">"avg_16S_g_soil"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;gradient_pos_rel_amt&gt; not specified. Calculating using avg_16S_g_soil column</span></span></code></pre></div>
<div class="alert alert-primary">
<p>Notice our dataframe did not contain the required
<code>gradient_pos_rel_amt</code> column, but the function was able to
calculate it using the data in the <code>gradient_pos_amt</code> column.
See below for reasons why you might want to pre-calculate this value
rather than having the function calculate it for you.</p>
</div>
<div class="section level3">
<h3 id="structure-of-qsip_sample_data">Structure of <code>qsip_sample_data</code><a class="anchor" aria-label="anchor" href="#structure-of-qsip_sample_data"></a>
</h3>
<p>Like other <code>qSIP2</code> objects, the
<code>qsip_sample_data</code> object is a list with a few key
components, but not meant to be inspected directly.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">sample_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;qSIP2::qsip_sample_data&gt;</span></span>
<span><span class="co">#&gt;  @ data                : tibble [284 × 7] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ sample_id           : chr [1:284] "149_F1" "149_F2" "149_F3" "149_F4" ...</span></span>
<span><span class="co">#&gt;  $ source_mat_id       : chr [1:284] "S149" "S149" "S149" "S149" ...</span></span>
<span><span class="co">#&gt;  $ gradient_position   : int [1:284] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ gradient_pos_density: num [1:284] 1.78 1.77 1.77 1.76 1.75 ...</span></span>
<span><span class="co">#&gt;  $ gradient_pos_amt    : num [1:284] 4474 987 4003 3960 5726 ...</span></span>
<span><span class="co">#&gt;  $ gradient_pos_rel_amt: num [1:284] 1.28e-04 2.83e-05 1.15e-04 1.14e-04 1.64e-04 ...</span></span>
<span><span class="co">#&gt;  $ dna_conc            : num [1:284] 0 0 0 0 0.00124 ...</span></span>
<span><span class="co">#&gt;  @ sample_id           : chr "sample"</span></span>
<span><span class="co">#&gt;  @ source_mat_id       : chr "source"</span></span>
<span><span class="co">#&gt;  @ gradient_position   : chr "Fraction"</span></span>
<span><span class="co">#&gt;  @ gradient_pos_density: chr "density_g_ml"</span></span>
<span><span class="co">#&gt;  @ gradient_pos_amt    : chr "avg_16S_g_soil"</span></span>
<span><span class="co">#&gt;  @ gradient_pos_rel_amt: chr "gradient_pos_rel_amt"</span></span></code></pre></div>
<p>The dataframe can be returned from the object using the
<code><a href="../reference/get_dataframe.html">get_dataframe()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_dataframe.html">get_dataframe</a></span><span class="op">(</span><span class="va">sample_object</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>First few rows of formatted sample data</caption>
<colgroup>
<col width="9%">
<col width="12%">
<col width="16%">
<col width="18%">
<col width="15%">
<col width="18%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">sample_id</th>
<th align="left">source_mat_id</th>
<th align="right">gradient_position</th>
<th align="right">gradient_pos_density</th>
<th align="right">gradient_pos_amt</th>
<th align="right">gradient_pos_rel_amt</th>
<th align="right">dna_conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">149_F1</td>
<td align="left">S149</td>
<td align="right">1</td>
<td align="right">1.778855</td>
<td align="right">4473.7081</td>
<td align="right">0.0001284</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">149_F2</td>
<td align="left">S149</td>
<td align="right">2</td>
<td align="right">1.773391</td>
<td align="right">986.6581</td>
<td align="right">0.0000283</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">149_F3</td>
<td align="left">S149</td>
<td align="right">3</td>
<td align="right">1.765742</td>
<td align="right">4002.7026</td>
<td align="right">0.0001149</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">149_F4</td>
<td align="left">S149</td>
<td align="right">4</td>
<td align="right">1.759185</td>
<td align="right">3959.7283</td>
<td align="right">0.0001137</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">149_F5</td>
<td align="left">S149</td>
<td align="right">5</td>
<td align="right">1.752629</td>
<td align="right">5725.7319</td>
<td align="right">0.0001643</td>
<td align="right">0.0012413</td>
</tr>
<tr class="even">
<td align="left">149_F6</td>
<td align="left">S149</td>
<td align="right">6</td>
<td align="right">1.746072</td>
<td align="right">7566.2722</td>
<td align="right">0.0002172</td>
<td align="right">0.0128156</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="validation-of-qsip_sample_data">Validation of <code>qsip_sample_data</code><a class="anchor" aria-label="anchor" href="#validation-of-qsip_sample_data"></a>
</h3>
<p>A valid <code>qsip_sample_data</code> object will have the required
columns, <code>sample_id</code> will contain unique values, and
<code>gradient_position</code> will be positive integers or
<code>-1</code>.</p>
<p>Additionally, the <code>density_g_ml</code> values should be in a
reasonable range (between 1.55 and 1.8)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># modifying density_g_ml to be too low will give an error</span></span>
<span><span class="va">example_sample_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>density_g_ml <span class="op">=</span> <span class="va">density_g_ml</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/qsip_sample_data.html">qsip_sample_data</a></span><span class="op">(</span></span>
<span>    sample_id <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>    source_mat_id <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>    gradient_position <span class="op">=</span> <span class="st">"Fraction"</span>,</span>
<span>    gradient_pos_density <span class="op">=</span> <span class="st">"density_g_ml"</span>,</span>
<span>    gradient_pos_amt <span class="op">=</span> <span class="st">"avg_16S_g_soil"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; &lt;gradient_pos_rel_amt&gt; not specified. Calculating using avg_16S_g_soil column</span></span>
<span><span class="co">#&gt; Error in qSIP2::validate_gradient_pos_density(dplyr::select(self@data, : some gradient_pos_density values are lower than 1.55</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="when-to-calculate-the-gradient_pos_rel_amt-values">When to calculate the <code>gradient_pos_rel_amt</code> values?<a class="anchor" aria-label="anchor" href="#when-to-calculate-the-gradient_pos_rel_amt-values"></a>
</h2>
<p>Typically all of the <code>gradient_pos_rel_amt</code> for a given
<code>source_mat_id</code> should add up to 1 (i.e. 100%), but there are
situations where it might be less than 1 (although never greater than).
For example, if you removed some fractions because they didn’t sequence
well or there was some other reason to remove a fraction. If those
removed fractions were 5% of the total data in that
<code>source_mat_id</code>, then you would expect the total of all
fractions to be 0.95 rather than 1. Another situation would be that
although you added 25ng to a centrifugation, you only recovered 20ng and
the rest was lost<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;a href=&quot;https://www.visitlex.com/guides/post/common-geeky-bourbon-terms-explained/#:~:text=Angel's%20Share&quot; class=&quot;external-link&quot;&gt;The
angel’s share and devil’s cut&lt;/a&gt;&lt;/p&gt;"><sup>2</sup></a>.</p>
<p>This matters because if you run the
<code><a href="../reference/add_gradient_pos_rel_amt.html">add_gradient_pos_rel_amt()</a></code> function on your dataframe then
the totals will add up to 1. You can then remove the rows from the
dataframe that you don’t want to include in the analysis, and sum of the
<code>gradient_pos_rel_amt</code> values will equal the appropriately
adjusted amount. But, if you remove the bad rows from the dataframe
first, and then let the <code><a href="../reference/qsip_sample_data.html">qsip_sample_data()</a></code> function create
the <code>gradient_pos_rel_amt</code> values, then they will be
artificially higher than they should be.</p>
<p>You can use a total abundance (qPCR or DNA concentrations) to
calculate the <code>gradient_pos_rel_amt</code> column.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_gradient_pos_rel_amt.html">add_gradient_pos_rel_amt</a></span><span class="op">(</span><span class="va">example_sample_df</span>,</span>
<span>  source_mat_id <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  amt <span class="op">=</span> <span class="st">"avg_16S_g_soil"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>sample data with <code>gradient_pos_rel_amt</code>
added</caption>
<colgroup>
<col width="8%">
<col width="8%">
<col width="10%">
<col width="15%">
<col width="12%">
<col width="18%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left">sample</th>
<th align="left">source</th>
<th align="right">Fraction</th>
<th align="right">density_g_ml</th>
<th align="right">dna_conc</th>
<th align="right">avg_16S_g_soil</th>
<th align="right">gradient_pos_rel_amt</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">149_F1</td>
<td align="left">S149</td>
<td align="right">1</td>
<td align="right">1.778855</td>
<td align="right">0.0000000</td>
<td align="right">4473.7081</td>
<td align="right">0.0001284</td>
</tr>
<tr class="even">
<td align="left">149_F2</td>
<td align="left">S149</td>
<td align="right">2</td>
<td align="right">1.773391</td>
<td align="right">0.0000000</td>
<td align="right">986.6581</td>
<td align="right">0.0000283</td>
</tr>
<tr class="odd">
<td align="left">149_F3</td>
<td align="left">S149</td>
<td align="right">3</td>
<td align="right">1.765742</td>
<td align="right">0.0000000</td>
<td align="right">4002.7026</td>
<td align="right">0.0001149</td>
</tr>
<tr class="even">
<td align="left">149_F4</td>
<td align="left">S149</td>
<td align="right">4</td>
<td align="right">1.759185</td>
<td align="right">0.0000000</td>
<td align="right">3959.7283</td>
<td align="right">0.0001137</td>
</tr>
<tr class="odd">
<td align="left">149_F5</td>
<td align="left">S149</td>
<td align="right">5</td>
<td align="right">1.752629</td>
<td align="right">0.0012413</td>
<td align="right">5725.7319</td>
<td align="right">0.0001643</td>
</tr>
<tr class="even">
<td align="left">149_F6</td>
<td align="left">S149</td>
<td align="right">6</td>
<td align="right">1.746072</td>
<td align="right">0.0128156</td>
<td align="right">7566.2722</td>
<td align="right">0.0002172</td>
</tr>
</tbody>
</table>
<p>Trying to run this function on a dataframe with an existing
<code>gradient_pos_rel_amt</code> will give an error, but it can be
overridden with the <code>overwrite = T</code> flag.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_gradient_pos_rel_amt.html">add_gradient_pos_rel_amt</a></span><span class="op">(</span><span class="va">example_sample_df</span>,</span>
<span>  source_mat_id <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  amt <span class="op">=</span> <span class="st">"avg_16S_g_soil"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_gradient_pos_rel_amt.html">add_gradient_pos_rel_amt</a></span><span class="op">(</span></span>
<span>    source_mat_id <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>    amt <span class="op">=</span> <span class="st">"avg_16S_g_soil"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Error: gradient_pos_rel_amt already exists! Set overwrite = TRUE if you want to overwrite</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set overwrite = TRUE to override the error, although this is a silly example here</span></span>
<span><span class="fu"><a href="../reference/add_gradient_pos_rel_amt.html">add_gradient_pos_rel_amt</a></span><span class="op">(</span><span class="va">example_sample_df</span>,</span>
<span>  source_mat_id <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  amt <span class="op">=</span> <span class="st">"avg_16S_g_soil"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_gradient_pos_rel_amt.html">add_gradient_pos_rel_amt</a></span><span class="op">(</span></span>
<span>    source_mat_id <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>    amt <span class="op">=</span> <span class="st">"avg_16S_g_soil"</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeff Kimbrel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
