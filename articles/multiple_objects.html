<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multiple qSIP Objects • qSIP2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple qSIP Objects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">qSIP2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.20.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/qSIP_workflow.html">Standard qSIP EAF Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/filtering.html">Filtering Features</a></li>
    <li><a class="dropdown-item" href="../articles/resampling.html">Resampling</a></li>
    <li><a class="dropdown-item" href="../articles/EAF.html">EAF Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/growth.html">Growth Workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jeffkimbrel/qSIP2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multiple qSIP Objects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jeffkimbrel/qSIP2/blob/master/vignettes/multiple_objects.Rmd" class="external-link"><code>vignettes/multiple_objects.Rmd</code></a></small>
      <div class="d-none name"><code>multiple_objects.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeffkimbrel/qSIP2" class="external-link">qSIP2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"qSIP2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] '0.20.2'</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>In <code>qSIP2</code>, you can run the standard EAF workflow with
multiple <code>qsip_data</code> objects at the same time. This vignette
will show you different ways to create and use multiple
<code>qsip_data</code> objects in the same workflow.</p>
</div>
<div class="section level2">
<h2 id="multiple-object-structure">Multiple Object Structure<a class="anchor" aria-label="anchor" href="#multiple-object-structure"></a>
</h2>
<p>The format for storing multiple <code>qsip_data</code> objects is a
simple named list, where the names are a descriptive but succinct name
for that comparison, and the value is the <code>qsip_data</code> object.
The list can be created in a few different ways, including “by hand”, by
formatting the <code><a href="../reference/get_comparison_groups.html">get_comparison_groups()</a></code> output, or providing
a dataframe to the dedicated <code><a href="../reference/run_comparison_groups.html">run_comparison_groups()</a></code>
function. Each of these are detailed below.</p>
</div>
<div class="section level2">
<h2 id="building-the-multi-qsip_data-object-by-hand">Building the multi <code>qsip_data</code> object “by hand”<a class="anchor" aria-label="anchor" href="#building-the-multi-qsip_data-object-by-hand"></a>
</h2>
<p>In the standard <code><a href="../articles/qSIP_workflow.html">vignette("qSIP_workflow")</a></code> vignette we
filtered the example object to create “normal” and “drought” objects,
and then proceeded through the workflow with these two objects
independently. However, these two objects can instead be combined using
<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> to work with both simultaneously. We can run a
validation function that will return <code>TRUE</code> if the list is
correct.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qsip_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_feature_filter.html">run_feature_filter</a></span><span class="op">(</span><span class="va">example_qsip_object</span>,</span>
<span>  unlabeled_source_mat_ids <span class="op">=</span> <span class="fu"><a href="../reference/get_all_by_isotope.html">get_all_by_isotope</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, <span class="st">"12C"</span><span class="op">)</span>,</span>
<span>  labeled_source_mat_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S178"</span>, <span class="st">"S179"</span>, <span class="st">"S180"</span><span class="op">)</span>,</span>
<span>  min_unlabeled_sources <span class="op">=</span> <span class="fl">6</span>, min_labeled_sources <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_unlabeled_fractions <span class="op">=</span> <span class="fl">5</span>, min_labeled_fractions <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_resampling.html">run_resampling</a></span><span class="op">(</span>with_seed <span class="op">=</span> <span class="fl">49</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_EAF_calculations.html">run_EAF_calculations</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qsip_drought</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_feature_filter.html">run_feature_filter</a></span><span class="op">(</span><span class="va">example_qsip_object</span>,</span>
<span>  unlabeled_source_mat_ids <span class="op">=</span> <span class="fu"><a href="../reference/get_all_by_isotope.html">get_all_by_isotope</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, <span class="st">"12C"</span><span class="op">)</span>,</span>
<span>  labeled_source_mat_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S200"</span>, <span class="st">"S201"</span>, <span class="st">"S202"</span>, <span class="st">"S203"</span><span class="op">)</span>,</span>
<span>  min_unlabeled_sources <span class="op">=</span> <span class="fl">6</span>, min_labeled_sources <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  min_unlabeled_fractions <span class="op">=</span> <span class="fl">5</span>, min_labeled_fractions <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_resampling.html">run_resampling</a></span><span class="op">(</span>with_seed <span class="op">=</span> <span class="fl">50</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_EAF_calculations.html">run_EAF_calculations</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qsip_list_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Normal"</span> <span class="op">=</span> <span class="va">qsip_normal</span>, </span>
<span>                          <span class="st">"Drought"</span> <span class="op">=</span> <span class="va">qsip_drought</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/is_qsip_data_list.html">is_qsip_data_list</a></span><span class="op">(</span><span class="va">qsip_list_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The list objects now holds both <code>qsip_data</code> objects, but
each can be accessed by name (e.g. <code>qsip_list_1$Normal</code>) if
needed. When building by hand, the main benefit of combining multiple
objects together is that you get shared reporting with summary functions
like <code><a href="../reference/summarize_EAF_values.html">summarize_EAF_values()</a></code> and
<code><a href="../reference/plot_EAF_values.html">plot_EAF_values()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarize_EAF_values.html">summarize_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list_1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre>
<table class="table">
<caption>First few rows from
<code><a href="../reference/summarize_EAF_values.html">summarize_EAF_values()</a></code>
</caption>
<colgroup>
<col width="5%">
<col width="7%">
<col width="8%">
<col width="13%">
<col width="7%">
<col width="7%">
<col width="12%">
<col width="13%">
<col width="11%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">group</th>
<th align="left">feature_id</th>
<th align="right">observed_EAF</th>
<th align="right">mean_resampled_EAF</th>
<th align="right">lower</th>
<th align="right">upper</th>
<th align="right">labeled_resamples</th>
<th align="right">unlabeled_resamples</th>
<th align="right">labeled_sources</th>
<th align="right">unlabeled_sources</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Normal</td>
<td align="left">ASV_1</td>
<td align="right">-0.0153107</td>
<td align="right">-0.0162090</td>
<td align="right">-0.0524399</td>
<td align="right">0.0239385</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">3</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Drought</td>
<td align="left">ASV_1</td>
<td align="right">-0.0333856</td>
<td align="right">-0.0322146</td>
<td align="right">-0.0792106</td>
<td align="right">0.0219181</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">Normal</td>
<td align="left">ASV_10</td>
<td align="right">0.1126260</td>
<td align="right">0.1116218</td>
<td align="right">0.0823812</td>
<td align="right">0.1405383</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">3</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Drought</td>
<td align="left">ASV_10</td>
<td align="right">0.0543136</td>
<td align="right">0.0542462</td>
<td align="right">0.0305884</td>
<td align="right">0.0788885</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">Drought</td>
<td align="left">ASV_100</td>
<td align="right">-0.0892684</td>
<td align="right">-0.0885048</td>
<td align="right">-0.1485629</td>
<td align="right">-0.0283228</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">3</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="left">ASV_102</td>
<td align="right">-0.0080214</td>
<td align="right">-0.0090271</td>
<td align="right">-0.0746514</td>
<td align="right">0.0546485</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">3</td>
<td align="right">8</td>
</tr>
</tbody>
</table>
<p>In the table above, you can see that the <code>feature_id</code>
column is repeated for each group.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_EAF_values.html">plot_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list_1</span>,</span>
<span>                top <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                error <span class="op">=</span> <span class="st">"ribbon"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre></div>
<p><img src="multiple_objects_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>Other helper functions can be used on the list as well.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/n_resamples.html">n_resamples</a></span><span class="op">(</span><span class="va">qsip_list_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   group   n_resamples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Normal         <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drought        <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="fu"><a href="../reference/resample_seed.html">resample_seed</a></span><span class="op">(</span><span class="va">qsip_list_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   group    seed</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Normal     49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drought    50</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dataframe-based-multi-qsip_data-object">Dataframe-based multi <code>qsip_data</code> object<a class="anchor" aria-label="anchor" href="#dataframe-based-multi-qsip_data-object"></a>
</h2>
<p>Although building the list by hand can be useful in organizing the
output, the functionality of the list structure really shines when you
start with a dataframe of comparisons you want to make. This workflow
will do all of the steps from the initial, unfiltered
<code>qsip_data</code> objects without the need to manually build each
comparison object.</p>
<div class="section level3">
<h3 id="dataframe-structure">Dataframe Structure<a class="anchor" aria-label="anchor" href="#dataframe-structure"></a>
</h3>
<p>The dataframe has a simple structure, and requires at a minimum three
columns. The <code>group</code> column is the name of the comparison
group, and the <code>unlabeled</code> and <code>labeled</code> columns
are vectors of the <code>source_material_id</code>s to use in the
comparison. Each row of the dataframe will be a separate comparison
group.</p>
</div>
<div class="section level3">
<h3 id="modifying-get_comparison_groups-output">Modifying <code>get_comparison_groups()</code> output<a class="anchor" aria-label="anchor" href="#modifying-get_comparison_groups-output"></a>
</h3>
<p>Recall that <code><a href="../reference/get_comparison_groups.html">get_comparison_groups()</a></code> attempts to guess
the relevant comparison groups using the metadata. For the example qsip
object, when grouping by “Moisture” we get</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_comparison_groups.html">get_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, group <span class="op">=</span> <span class="st">"Moisture"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   Moisture `12C`                  `13C`                 </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Normal   S149, S150, S151, S152 S178, S179, S180      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drought  S161, S162, S163, S164 S200, S201, S202, S203</span></span></code></pre></div>
<p>The output is already in our desired format, and all that is needed
is some slight tweaking of the column names using
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code> (or <code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">dplyr::rename()</a></code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_comparison_groups.html">get_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, group <span class="op">=</span> <span class="st">"Moisture"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"group"</span> <span class="op">=</span> <span class="va">Moisture</span>, <span class="st">"unlabeled"</span> <span class="op">=</span> <span class="st">"12C"</span>, <span class="st">"labeled"</span> <span class="op">=</span> <span class="st">"13C"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   group   unlabeled              labeled               </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Normal  S149, S150, S151, S152 S178, S179, S180      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drought S161, S162, S163, S164 S200, S201, S202, S203</span></span></code></pre></div>
<p>This dataframe can be passed directly to
<code><a href="../reference/run_comparison_groups.html">run_comparison_groups()</a></code> to create the multi
<code>qsip_data</code> object. <code><a href="../reference/run_comparison_groups.html">run_comparison_groups()</a></code>
requires the dataframe and a <code>qsip_data</code> object as the first
two arguments. It has three additional optional arguments that globally
apply to all comparisons: <code>allow_failures</code>
(<em>boolean</em>), <code>seed</code> (<em>integer</em>), and
<code>resamples</code> (<em>integer</em>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qsip_list_2</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_comparison_groups.html">get_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, group <span class="op">=</span> <span class="st">"Moisture"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"group"</span> <span class="op">=</span> <span class="va">Moisture</span>, <span class="st">"unlabeled"</span> <span class="op">=</span> <span class="st">"12C"</span>, <span class="st">"labeled"</span> <span class="op">=</span> <span class="st">"13C"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_comparison_groups.html">run_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, </span>
<span>                        seed <span class="op">=</span> <span class="fl">99</span>,</span>
<span>                        allow_failures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="fu"><a href="../reference/is_qsip_data_list.html">is_qsip_data_list</a></span><span class="op">(</span><span class="va">qsip_list_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Plotting the values here should give almost identical results (within
sampling error) to the previous plot, but this time we have enabled the
<code>allow_failures</code> option so we get resampling success as
well.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_EAF_values.html">plot_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list_2</span>,</span>
<span>                top <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                success_ratio <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>                error <span class="op">=</span> <span class="st">"ribbon"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre></div>
<p><img src="multiple_objects_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="custom-dataframe-for-ultimate-control">Custom dataframe for ultimate control<a class="anchor" aria-label="anchor" href="#custom-dataframe-for-ultimate-control"></a>
</h3>
<p>It is possible to make a dataframe from scratch (e.g. as an excel
spreadsheet) to give even more fine-grain control over each comparison.
Here, rather than setting parameters that will be treated as identical
for all comparisons (like <code>seed = 99</code> above), here additional
columns can be used to set the values independently per row. An example
dataframe is included in the <code>qSIP2</code> package called
<code>example_group_dataframe</code>. This dataframe is shown below, but
with some columns temporarily removed for brevity (those columns will be
discussed later).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_group_dataframe</span></span></code></pre></div>
<table class="table">
<caption>Example dataframe with some columns removed</caption>
<colgroup>
<col width="20%">
<col width="23%">
<col width="23%">
<col width="15%">
<col width="10%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">group</th>
<th align="left">unlabeled</th>
<th align="left">labeled</th>
<th align="left">allow_failures</th>
<th align="right">resamples</th>
<th align="right">seed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Normal</td>
<td align="left">S149, S150, S151, S152</td>
<td align="left">S178, S179, S180</td>
<td align="left">T</td>
<td align="right">500</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">Drought</td>
<td align="left">S161, S162, S163, S164</td>
<td align="left">S200, S201, S202, S203</td>
<td align="left">T</td>
<td align="right">1000</td>
<td align="right">101</td>
</tr>
<tr class="odd">
<td align="left">Drought against all</td>
<td align="left">12C</td>
<td align="left">S200, S201, S202, S203</td>
<td align="left">T</td>
<td align="right">1000</td>
<td align="right">102</td>
</tr>
<tr class="even">
<td align="left">Normal_S178</td>
<td align="left">S149, S150, S151, S152</td>
<td align="left">S178</td>
<td align="left">T</td>
<td align="right">1000</td>
<td align="right">103</td>
</tr>
<tr class="odd">
<td align="left">Normal_S179</td>
<td align="left">S149, S150, S151, S152</td>
<td align="left">S179</td>
<td align="left">T</td>
<td align="right">1000</td>
<td align="right">104</td>
</tr>
<tr class="even">
<td align="left">Normal_S180</td>
<td align="left">S149, S150, S151, S152</td>
<td align="left">S180</td>
<td align="left">T</td>
<td align="right">1000</td>
<td align="right">105</td>
</tr>
</tbody>
</table>
<p>This dataframe shows the customizability of the format, including
retaining the ability to use isotope terms like “12C” to grab all source
material IDs with that isotope.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qsip_list_3</span> <span class="op">=</span> <span class="va">example_group_dataframe</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_comparison_groups.html">run_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■                          </span>  17%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■                     </span>  33%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  67%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■      </span>  83%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="fu"><a href="../reference/resample_seed.html">resample_seed</a></span><span class="op">(</span><span class="va">qsip_list_3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   group                seed</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Drought               101</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drought against all   102</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Normal                100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Normal_S178           103</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Normal_S179           104</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Normal_S180           105</span></span></code></pre></div>
<p>If you use the additional arguments in
<code><a href="../reference/run_comparison_groups.html">run_comparison_groups()</a></code> then they will override the values
in the dataframe.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qsip_list_4</span> <span class="op">=</span> <span class="va">example_group_dataframe</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_comparison_groups.html">run_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span>,</span>
<span>                        seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■                          </span>  17%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■                     </span>  33%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  67%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■      </span>  83%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="fu"><a href="../reference/resample_seed.html">resample_seed</a></span><span class="op">(</span><span class="va">qsip_list_4</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   group                seed</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Drought                42</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drought against all    42</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Normal                 42</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Normal_S178            42</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Normal_S179            42</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Normal_S180            42</span></span></code></pre></div>
<p>The are 4 additional dataframe columns that
<code><a href="../reference/run_comparison_groups.html">run_comparison_groups()</a></code> will accept:
<code>min_unlabeled_sources</code>, <code>min_labeled_sources</code>,
<code>min_unlabeled_fractions</code>, and
<code>min_labeled_fractions</code>. These columns are used to set the
minimum number of sources and fractions required for each comparison.
The full example dataframe does additionally contain these columns.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarize_EAF_values.html">summarize_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list_3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature_id</span> <span class="op">==</span> <span class="st">"ASV_1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   group              feature_id observed_EAF mean_resampled_EAF   lower    upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Drought            ASV_1         -<span style="color: #BB0000;">0.049</span><span style="color: #BB0000; text-decoration: underline;">2</span>             -<span style="color: #BB0000;">0.048</span><span style="color: #BB0000; text-decoration: underline;">9</span>  -<span style="color: #BB0000;">0.108</span>   0.011<span style="text-decoration: underline;">3</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drought against a… ASV_1         -<span style="color: #BB0000;">0.033</span><span style="color: #BB0000; text-decoration: underline;">4</span>             -<span style="color: #BB0000;">0.032</span><span style="color: #BB0000; text-decoration: underline;">8</span>  -<span style="color: #BB0000;">0.079</span><span style="color: #BB0000; text-decoration: underline;">8</span>  0.019<span style="text-decoration: underline;">5</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Normal             ASV_1          0.000<span style="text-decoration: underline;">455</span>            0.001<span style="text-decoration: underline;">38</span> -<span style="color: #BB0000;">0.032</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.035<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Normal_S178        ASV_1          0.041<span style="text-decoration: underline;">0</span>              0.042<span style="text-decoration: underline;">1</span>   0.021<span style="text-decoration: underline;">4</span>  0.060<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Normal_S179        ASV_1         -<span style="color: #BB0000;">0.025</span><span style="color: #BB0000; text-decoration: underline;">6</span>             -<span style="color: #BB0000;">0.025</span><span style="color: #BB0000; text-decoration: underline;">1</span>  -<span style="color: #BB0000;">0.045</span><span style="color: #BB0000; text-decoration: underline;">4</span> -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">03</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Normal_S180        ASV_1         -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">0</span>             -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">1</span>  -<span style="color: #BB0000;">0.037</span><span style="color: #BB0000; text-decoration: underline;">8</span>  0.005<span style="text-decoration: underline;">64</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: labeled_resamples &lt;int&gt;, unlabeled_resamples &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   labeled_sources &lt;int&gt;, unlabeled_sources &lt;int&gt;</span></span></span></code></pre></div>
<p>But, keep in mind that each row of the dataframe will be filtered
differently, and therefore some <code>feature_id</code>s could be
missing from certain comparisons. For example, ASV_311 only appears in
the two “Drought” comparisons.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarize_EAF_values.html">summarize_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list_3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature_id</span> <span class="op">==</span> <span class="st">"ASV_311"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 10</span></span></span>
<span><span class="co">#&gt;   group feature_id observed_EAF mean_resampled_EAF lower upper labeled_resamples</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Drou… ASV_311           0.906              0.903 0.650 1.14               <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Drou… ASV_311           0.693              0.693 0.535 0.867              <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: unlabeled_resamples &lt;int&gt;, labeled_sources &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   unlabeled_sources &lt;int&gt;</span></span></span></code></pre></div>
<p>And although you can plot all together, more than a few objects might
make the plots harder to read. But, because it is a simple list you can
always still access the individual objects if needed using the
<code>$</code> operator (e.g. <code>qsip_list_3$Drought</code>) or
<code>[]</code> brackets
(e.g. <code>qsip_list_3[c("Drought", "Normal")]</code>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_EAF_values.html">plot_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list_3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Drought"</span>, <span class="st">"Normal"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                error <span class="op">=</span> <span class="st">"ribbon"</span>,</span>
<span>                top <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre></div>
<p><img src="multiple_objects_files/figure-html/unnamed-chunk-18-1.png" width="768"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeff Kimbrel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
