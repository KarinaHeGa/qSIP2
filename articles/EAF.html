<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>EAF Calculations • qSIP2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EAF Calculations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">qSIP2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.20.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/qSIP_workflow.html">Standard qSIP EAF Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/filtering.html">Filtering Features</a></li>
    <li><a class="dropdown-item" href="../articles/resampling.html">Resampling</a></li>
    <li><a class="dropdown-item" href="../articles/EAF.html">EAF Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/growth.html">Growth Workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jeffkimbrel/qSIP2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>EAF Calculations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jeffkimbrel/qSIP2/blob/master/vignettes/EAF.Rmd" class="external-link"><code>vignettes/EAF.Rmd</code></a></small>
      <div class="d-none name"><code>EAF.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeffkimbrel/qSIP2" class="external-link">qSIP2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"qSIP2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] '0.20.3.9000'</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>After your <code>qsip_data</code> object has been filtered and
resampled, the last step is to calculate the excess atom fraction (EAF)
values for each feature. The EAF is a measure of the proportion of a
feature that is derived from the labeled substrate. For each of the
resamples, the <code><a href="../reference/run_EAF_calculations.html">run_EAF_calculations()</a></code> runs equations from
Hungate et al. 2015<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://journals.asm.org/doi/10.1128/aem.02280-15" class="external-link uri"&gt;https://journals.asm.org/doi/10.1128/aem.02280-15&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> to calculate EAF values, and the
<code><a href="../reference/summarize_EAF_values.html">summarize_EAF_values()</a></code> function calculates the mean and
confidence intervals for each feature.</p>
</div>
<div class="section level2">
<h2 id="getting-eaf-values">Getting EAF values<a class="anchor" aria-label="anchor" href="#getting-eaf-values"></a>
</h2>
<p>We can start by making a <code>qsip_data</code> object with multiple
comparisons using code from the <code>vignette("multiple_objects)</code>
vignette. This will make two comparisons (“Normal” and “Drought”) that
include the output from <code><a href="../reference/run_EAF_calculations.html">run_EAF_calculations()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qsip_list</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_comparison_groups.html">get_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, group <span class="op">=</span> <span class="st">"Moisture"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"group"</span> <span class="op">=</span> <span class="va">Moisture</span>, <span class="st">"unlabeled"</span> <span class="op">=</span> <span class="st">"12C"</span>, <span class="st">"labeled"</span> <span class="op">=</span> <span class="st">"13C"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_comparison_groups.html">run_comparison_groups</a></span><span class="op">(</span><span class="va">example_qsip_object</span>, </span>
<span>                        seed <span class="op">=</span> <span class="fl">99</span>,</span>
<span>                        allow_failures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50%</span></span>
<span><span class="co">#&gt; Finished groups <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<p>Plotting the results shows a wide range of EAF values between the two
comparisons.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_EAF_values.html">plot_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre></div>
<p><img src="EAF_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>The 90% confidence interval is calculated by default, but this can be
modified and added to the plot with the <code>confidence</code> and
<code>error</code> arguments.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_EAF_values.html">plot_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list</span>, </span>
<span>                confidence <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>                error <span class="op">=</span> <span class="st">"ribbon"</span>,</span>
<span>                title <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.95</span></span></code></pre></div>
<p><img src="EAF_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>The number of features can be filtered to include the <em>n</em> with
the highest EAF.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_EAF_values.html">plot_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list</span>, </span>
<span>                top <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                error <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>                title <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre></div>
<p><img src="EAF_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>By default, the facets do not share the same y-axis so each
comparison are sorted from highto low independently. But, if you want to
compare the EAF values between the two comparisons, you can set
<code>shared_y = TRUE</code>. Keep in mind that the top <em>n</em> is
calculated for each, so you may end up with more than <em>n</em>
features in the plot if there isn’t much overlap between the two
comparisons.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_EAF_values.html">plot_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list</span>, </span>
<span>                top <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                shared_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                error <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>                title <span class="op">=</span> <span class="st">"Y-axis shared for both comparisons"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: When setting &lt;shared_y&gt; to TRUE and also passing a value to &lt;top&gt;,</span></span>
<span><span class="co">#&gt; there will likely be missing data in the plots if a feature is in the top n of</span></span>
<span><span class="co">#&gt; one comparison, but not in the other.</span></span>
<span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre></div>
<p><img src="EAF_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="alert alert-danger">
<p>As seen in the warning above, a current limitation when using
<code>shared_y = TRUE</code> together with the <code>top</code> argument
is that only the top <em>n</em> will be shown per facet, giving a blank
value for any features that are not in the top <em>n</em> for that
comparison. But, this doesn’t mean they don’t have EAF values or that
the feature was not found. I hope to fix this limitation in the
future.</p>
</div>
<p>As a reminder from the resampling vignette, the “successess” in the
legend and colors refer to whether the resampling was successful above a
certain threshold. The plot will display whether they pass/fail if the
<code>allow_failures</code> argument is set to <code>TRUE</code> in the
resampling step.</p>
</div>
<div class="section level3">
<h3 id="dataframe">Dataframe<a class="anchor" aria-label="anchor" href="#dataframe"></a>
</h3>
<p>You can also return the results as a dataframe using
<code><a href="../reference/summarize_EAF_values.html">summarize_EAF_values()</a></code> and a desired confidence (default is
90%).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarize_EAF_values.html">summarize_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre>
<table class="table">
<caption>The first few lines of output</caption>
<colgroup>
<col width="5%">
<col width="7%">
<col width="8%">
<col width="13%">
<col width="7%">
<col width="7%">
<col width="12%">
<col width="13%">
<col width="11%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">group</th>
<th align="left">feature_id</th>
<th align="right">observed_EAF</th>
<th align="right">mean_resampled_EAF</th>
<th align="right">lower</th>
<th align="right">upper</th>
<th align="right">labeled_resamples</th>
<th align="right">unlabeled_resamples</th>
<th align="right">labeled_sources</th>
<th align="right">unlabeled_sources</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Drought</td>
<td align="left">ASV_1</td>
<td align="right">-0.0491540</td>
<td align="right">-0.0483554</td>
<td align="right">-0.1082032</td>
<td align="right">0.0087336</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="left">ASV_1</td>
<td align="right">0.0004555</td>
<td align="right">0.0000135</td>
<td align="right">-0.0325729</td>
<td align="right">0.0356580</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Drought</td>
<td align="left">ASV_10</td>
<td align="right">0.0547586</td>
<td align="right">0.0550897</td>
<td align="right">0.0344674</td>
<td align="right">0.0747572</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="left">ASV_10</td>
<td align="right">0.1121811</td>
<td align="right">0.1116458</td>
<td align="right">0.0713690</td>
<td align="right">0.1506676</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Drought</td>
<td align="left">ASV_100</td>
<td align="right">-0.1116096</td>
<td align="right">-0.1110421</td>
<td align="right">-0.1681262</td>
<td align="right">-0.0503753</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="left">ASV_100</td>
<td align="right">0.0090370</td>
<td align="right">0.0088377</td>
<td align="right">-0.0523892</td>
<td align="right">0.0703022</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="more-details">More details<a class="anchor" aria-label="anchor" href="#more-details"></a>
</h2>
<p>Individual features can be inspected further to help understand why
their EAF values were calculated as they were. As an example, we will
pick 4 features that had a range of EAF values for the “Drought”
comparison, one each with high, medium, low, and negative EAF
values.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ASV_72"</span>, <span class="st">"ASV_7"</span>, <span class="st">"ASV_180"</span>, <span class="st">"ASV_100"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summarize_EAF_values.html">summarize_EAF_values</a></span><span class="op">(</span><span class="va">qsip_list</span><span class="op">$</span><span class="va">Drought</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">features</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Confidence level = 0.9</span></span></code></pre>
<table class="table">
<caption>EAF results for 4 chosen features</caption>
<colgroup>
<col width="8%">
<col width="9%">
<col width="13%">
<col width="8%">
<col width="8%">
<col width="13%">
<col width="14%">
<col width="11%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">feature_id</th>
<th align="right">observed_EAF</th>
<th align="right">mean_resampled_EAF</th>
<th align="right">lower</th>
<th align="right">upper</th>
<th align="right">labeled_resamples</th>
<th align="right">unlabeled_resamples</th>
<th align="right">labeled_sources</th>
<th align="right">unlabeled_sources</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ASV_72</td>
<td align="right">0.5271129</td>
<td align="right">0.5246305</td>
<td align="right">0.3529541</td>
<td align="right">0.7072885</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">ASV_7</td>
<td align="right">0.2305506</td>
<td align="right">0.2307068</td>
<td align="right">0.1799998</td>
<td align="right">0.2823904</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">ASV_180</td>
<td align="right">0.0308346</td>
<td align="right">0.0318743</td>
<td align="right">-0.0425104</td>
<td align="right">0.0994295</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">ASV_100</td>
<td align="right">-0.1116096</td>
<td align="right">-0.1110421</td>
<td align="right">-0.1681262</td>
<td align="right">-0.0503753</td>
<td align="right">1000</td>
<td align="right">1000</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>Using a combination of <code><a href="../reference/plot_feature_curves.html">plot_feature_curves()</a></code> and
<code><a href="../reference/plot_feature_resamplings.html">plot_feature_resamplings()</a></code> we can plot these 4 features
(with some help from the <code>patchwork</code> library).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_curves.html">plot_feature_curves</a></span><span class="op">(</span><span class="va">qsip_list</span><span class="op">$</span><span class="va">Drought</span>, <span class="va">features</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">feature_id</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_resamplings.html">plot_feature_resamplings</a></span><span class="op">(</span><span class="va">qsip_list</span><span class="op">$</span><span class="va">Drought</span>, <span class="va">features</span>, intervals <span class="op">=</span> <span class="st">"bar"</span>, confidence <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">feature_id</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">a</span> <span class="op">/</span> <span class="va">b</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axes <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code></pre></div>
<p><img src="EAF_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
<p>For ASV_7 and ASV_72, it is clear in “A” that the 13C labeled isotope
has a nice shift compared to the unlabeled 12C sources. Indeed, the
resampling results summarized in “B” also show a clear distinction with
non-overlapping confidence intervals. ASV_180, which had an EAF value
close to zero shows a much smaller density shift between the unlabeled
and labeled samples, and the resampling results show overlapping
confidence intervals.</p>
<p>ASV_100, on the other hand, shows a negative EAF value. In “A” we can
see the peaks of the 13C do appear shifted left of the 12C, and although
the confidence intervals do not overlap, we don’t expect to see lower
13C density values compared to 12C. In “A”, it appears two of the 13C
lines abruptly end, which may be a sign that ASV_100 doesn’t occur in as
many fractions as necessary.</p>
<p>The <code><a href="../reference/plot_feature_occurrence.html">plot_feature_occurrence()</a></code> function can be used to
see how often a feature occurs in the samples and give some idea about
whether they span the range of densities, are found in fractions close
or far from one another, and how the calculated WAD value is affected by
these occurrences.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_feature_occurrence.html">plot_feature_occurrence</a></span><span class="op">(</span><span class="va">qsip_list</span><span class="op">$</span><span class="va">Drought</span>, <span class="va">features</span><span class="op">)</span></span></code></pre></div>
<p><img src="EAF_files/figure-html/unnamed-chunk-13-1.png" width="960"></p>
<p>The plot above does show that ASV_100 stops appearing in some labeled
sources after a density of ~1.7. With more arguments we can add the WAD
and relative abundance values to the make the following figure. Here,
the size of the circle represents the relative abundance of the feature
in the sample, and for ASV_100 we see the most abundant fraction does
heavily influence the calculated WAD value (vertical bar). So, although
missing data on the “right side” of the curve may lead to issues, it
doesn’t seem to affect the WAD value for ASV_100, assuming the peak of
the values are in that most abundant fraction.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_feature_occurrence.html">plot_feature_occurrence</a></span><span class="op">(</span><span class="va">qsip_list</span><span class="op">$</span><span class="va">Drought</span>, </span>
<span>                        <span class="va">features</span>,</span>
<span>                        show_wad <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        scale <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></code></pre></div>
<p><img src="EAF_files/figure-html/unnamed-chunk-14-1.png" width="960"></p>
<p>The above plot can also help identify additional potential issues.
For example, ASV_72 was one of the features with the highest EAF values,
but it looks like source S200 only has it in the extremely heavy
fractions, and it has a calculated WAD that is much higher than the
other 13C sources. When we ran <code><a href="../reference/run_comparison_groups.html">run_comparison_groups()</a></code> at
the very beginning we didn’t define a minimum number of fractions, so
the default of 2 was used. We might, however, consider increasing the
minimum number of labeled fractions required to remove sources with
feature occurrences like ASV_72 in source S200.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeff Kimbrel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
