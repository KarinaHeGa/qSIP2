<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Source Data • qSIP2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Source Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">qSIP2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.20.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/qSIP_workflow.html">Standard qSIP EAF Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/filtering.html">Filtering Features</a></li>
    <li><a class="dropdown-item" href="../articles/resampling.html">Resampling</a></li>
    <li><a class="dropdown-item" href="../articles/EAF.html">EAF Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/growth.html">Growth Workflow</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jeffkimbrel/qSIP2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Source Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jeffkimbrel/qSIP2/blob/master/vignettes/source_data.Rmd" class="external-link"><code>vignettes/source_data.Rmd</code></a></small>
      <div class="d-none name"><code>source_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeffkimbrel/qSIP2" class="external-link">qSIP2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"qSIP2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] '0.20.5'</span></span></code></pre></div>
<div class="section level2">
<h2 id="source-material-and-metadata">Source Material and Metadata<a class="anchor" aria-label="anchor" href="#source-material-and-metadata"></a>
</h2>
<p>In a SIP experiment, the “source material” are the subjects that you
are running experiments with (e.g. a culture tube or a plant root). For
qSIP the source material would then be each DNA extraction that is
loaded into its own column for isopycnic centrifugation. The “source
data” is the highest level of metadata with a row corresponding to each
original experimental or source material object. Because each source is
fractionated into samples, it will have a one-to-many relationship with
the “sample data” (see <code><a href="../articles/sample_data.html">vignette("sample_data")</a></code>).</p>
<p>There are a few required columns for valid source data including a
unique ID (the <code>source_mat_id</code>), some measure of quantitative
abundance for the source material (either total DNA or qPCR copies), and
an isotope and substrate designation (the <code>isotope</code> and
<code>isotopolog</code>, respectively). Ideally, the substrate should be
a standardized compound ID (e.g. PubChem <a href="https://pubchem.ncbi.nlm.nih.gov/compound/6137" class="external-link">6137</a> for
L-methionine), but for <code>qSIP2</code> is can just be descriptive
text like “methionine”. In addition to the required columns, the source
data can contain as many other ancillary columns as necessary to
describe the experiment. These additional columns might contain
important experiment-specific metadata that you will use to group and
subset your source material in the qSIP workflow. But, they can also be
further details that you might not need for qSIP, but it may make sense
to just keep everything included if they’re already in your
<code>.txt.</code> or excel file.</p>
<p>An example source dataframe is included in the <code>qSIP2</code>
package called <code>example_source_df</code>. It includes a 13C glucose
addition study with two different moisture treatments (“normal” and
“drought”) in quadruplicate, with one only in triplicate. Each
experiment contains both unlabeled 12C and labeled 13C source material,
but you may have an experiment where different 13C treatments share the
same 12C source material. For example, a split experiment where you have
one 12C data set that is split into many experimental conditions each
with a different isotopolog.</p>
<table class="table">
<caption>The first few rows of <code>example_source_df</code>
</caption>
<thead><tr class="header">
<th align="left">source</th>
<th align="right">total_copies_per_g</th>
<th align="right">total_dna</th>
<th align="left">Isotope</th>
<th align="left">Moisture</th>
<th align="left">isotopolog</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">S149</td>
<td align="right">34838665</td>
<td align="right">74.46539</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S150</td>
<td align="right">53528072</td>
<td align="right">109.01522</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S151</td>
<td align="right">95774992</td>
<td align="right">182.16852</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S152</td>
<td align="right">9126192</td>
<td align="right">23.68963</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S161</td>
<td align="right">41744046</td>
<td align="right">67.62552</td>
<td align="left">12C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S162</td>
<td align="right">49402713</td>
<td align="right">94.21217</td>
<td align="left">12C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="qsip2-source-data-object">qSIP2 Source Data Object<a class="anchor" aria-label="anchor" href="#qsip2-source-data-object"></a>
</h2>
<p>Once the dataframe is ready with at least the three required columns
(<code>source_mat_id</code>, <code>isotope</code> and
<code>isotopolog</code>), the next step is to convert it to a
<code>qsip_source_data</code> object. This is one of the main
<code>qSIP2</code> objects to hold and validate the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">source_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qsip_source_data.html">qsip_source_data</a></span><span class="op">(</span><span class="va">example_source_df</span>,</span>
<span>  isotope <span class="op">=</span> <span class="st">"Isotope"</span>,</span>
<span>  isotopolog <span class="op">=</span> <span class="st">"isotopolog"</span>,</span>
<span>  source_mat_id <span class="op">=</span> <span class="st">"source"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">source_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "qSIP2::qsip_source_data" "S7_object"</span></span></code></pre></div>
<div class="alert alert-primary">
<p>While these three columns are required for the EAF workflow, there
are additional columns required for the growth workflow
(<code>timepoint</code>, <code>total_abundance</code> and
<code>volume</code>). These can remain empty/unassigned for this
vignette, and will be detailed in a forthcoming growth workflow
vignette.</p>
</div>
<p>Note, your column names in the dataframe don’t have to specifically
be the required column names, so no need to edit your original table
headers if they don’t match. For example, if you’re
<code>isotopolog</code> column is titled “substrate”, it isn’t necessary
to rename your column. If your column names are already standardized
names, then there is no need to assign while creating the object. For
example, the <code>isotopolog</code> column is already title
“isotopolog”, so if it is omitted from the object creation then the
column will still be identified and used.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this will still work even though the isotopolog parameter is not assigned</span></span>
<span><span class="fu"><a href="../reference/qsip_source_data.html">qsip_source_data</a></span><span class="op">(</span><span class="va">example_source_df</span>,</span>
<span>  isotope <span class="op">=</span> <span class="st">"Isotope"</span>,</span>
<span>  source_mat_id <span class="op">=</span> <span class="st">"source"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="structure-of-qsip_source_data">Structure of <code>qsip_source_data</code><a class="anchor" aria-label="anchor" href="#structure-of-qsip_source_data"></a>
</h3>
<p>While this object is not meant to be inspected or worked with outside
of <code>qSIP2</code> functions, a quick <code><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse()</a></code> can show
the structure of it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">source_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;qSIP2::qsip_source_data&gt;</span></span>
<span><span class="co">#&gt;  @ data           : tibble [15 × 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ isotope           : chr [1:15] "12C" "12C" "12C" "12C" ...</span></span>
<span><span class="co">#&gt;  $ isotopolog        : chr [1:15] "glucose" "glucose" "glucose" "glucose" ...</span></span>
<span><span class="co">#&gt;  $ source_mat_id     : chr [1:15] "S149" "S150" "S151" "S152" ...</span></span>
<span><span class="co">#&gt;  $ total_copies_per_g: num [1:15] 34838665 53528072 95774992 9126192 41744046 ...</span></span>
<span><span class="co">#&gt;  $ total_dna         : num [1:15] 74.5 109 182.2 23.7 67.6 ...</span></span>
<span><span class="co">#&gt;  $ Moisture          : chr [1:15] "Normal" "Normal" "Normal" "Normal" ...</span></span>
<span><span class="co">#&gt;  @ isotope        : chr "Isotope"</span></span>
<span><span class="co">#&gt;  @ isotopolog     : chr "isotopolog"</span></span>
<span><span class="co">#&gt;  @ source_mat_id  : chr "source"</span></span>
<span><span class="co">#&gt;  @ timepoint      : chr "NULL"</span></span>
<span><span class="co">#&gt;  @ total_abundance: chr "NULL"</span></span>
<span><span class="co">#&gt;  @ volume         : chr "NULL"</span></span></code></pre></div>
<p>The original dataframe is contained in the <code>@data</code> slot,
however, some column names have been modified to the standard names,
while keeping a record of the original names in the corresponding
slots.</p>
<table class="table">
<caption>Column name differences</caption>
<thead><tr class="header">
<th align="left">Original Names</th>
<th align="left">qSIP Names</th>
<th align="left">Original Name Slot</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">source</td>
<td align="left">source_mat_id</td>
<td align="left"><span class="citation">@source_mat_id</span></td>
</tr>
<tr class="even">
<td align="left">Isotope</td>
<td align="left">isotope</td>
<td align="left"><span class="citation">@isotope</span></td>
</tr>
<tr class="odd">
<td align="left">substrate</td>
<td align="left">isotopolog</td>
<td align="left"><span class="citation">@isotopolog</span></td>
</tr>
</tbody>
</table>
<p>To get the dataframe back out of the <code>qsip_source_data</code>
object you can use the <code><a href="../reference/get_dataframe.html">get_dataframe()</a></code> method with
<code>original_headers</code> set to <code>TRUE</code> or
<code>FALSE</code>, depending on your needs. But, note that the columns
may be in a different order than the dataframe you started with.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_dataframe.html">get_dataframe</a></span><span class="op">(</span><span class="va">source_object</span>, original_headers <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Isotope</th>
<th align="left">isotopolog</th>
<th align="left">source</th>
<th align="right">total_copies_per_g</th>
<th align="right">total_dna</th>
<th align="left">Moisture</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S149</td>
<td align="right">34838665</td>
<td align="right">74.46539</td>
<td align="left">Normal</td>
</tr>
<tr class="even">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S150</td>
<td align="right">53528072</td>
<td align="right">109.01522</td>
<td align="left">Normal</td>
</tr>
<tr class="odd">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S151</td>
<td align="right">95774992</td>
<td align="right">182.16852</td>
<td align="left">Normal</td>
</tr>
<tr class="even">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S152</td>
<td align="right">9126192</td>
<td align="right">23.68963</td>
<td align="left">Normal</td>
</tr>
<tr class="odd">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S161</td>
<td align="right">41744046</td>
<td align="right">67.62552</td>
<td align="left">Drought</td>
</tr>
<tr class="even">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S162</td>
<td align="right">49402713</td>
<td align="right">94.21217</td>
<td align="left">Drought</td>
</tr>
<tr class="odd">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S163</td>
<td align="right">47777726</td>
<td align="right">87.82524</td>
<td align="left">Drought</td>
</tr>
<tr class="even">
<td align="left">12C</td>
<td align="left">glucose</td>
<td align="left">S164</td>
<td align="right">48734282</td>
<td align="right">75.97274</td>
<td align="left">Drought</td>
</tr>
<tr class="odd">
<td align="left">13C</td>
<td align="left">glucose</td>
<td align="left">S178</td>
<td align="right">62964478</td>
<td align="right">73.89526</td>
<td align="left">Normal</td>
</tr>
<tr class="even">
<td align="left">13C</td>
<td align="left">glucose</td>
<td align="left">S179</td>
<td align="right">49475460</td>
<td align="right">68.65182</td>
<td align="left">Normal</td>
</tr>
<tr class="odd">
<td align="left">13C</td>
<td align="left">glucose</td>
<td align="left">S180</td>
<td align="right">51720787</td>
<td align="right">81.36874</td>
<td align="left">Normal</td>
</tr>
<tr class="even">
<td align="left">13C</td>
<td align="left">glucose</td>
<td align="left">S200</td>
<td align="right">59426155</td>
<td align="right">71.19377</td>
<td align="left">Drought</td>
</tr>
<tr class="odd">
<td align="left">13C</td>
<td align="left">glucose</td>
<td align="left">S201</td>
<td align="right">56379702</td>
<td align="right">73.78225</td>
<td align="left">Drought</td>
</tr>
<tr class="even">
<td align="left">13C</td>
<td align="left">glucose</td>
<td align="left">S202</td>
<td align="right">42562198</td>
<td align="right">108.11436</td>
<td align="left">Drought</td>
</tr>
<tr class="odd">
<td align="left">13C</td>
<td align="left">glucose</td>
<td align="left">S203</td>
<td align="right">49914369</td>
<td align="right">80.48608</td>
<td align="left">Drought</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="validation-of-qsip_source_data">Validation of <code>qsip_source_data</code><a class="anchor" aria-label="anchor" href="#validation-of-qsip_source_data"></a>
</h3>
<p>While constructing a <code>qsip_source_data</code> object there are a
few validation checks that are performed. For now, the only checks are
that the <code>source_mat_id</code> is unique for each row, and that the
<code>isotope</code> field is an appropriate value. This doesn’t just
mean it is a value that makes sense, but also that it is one of the
isotopes that <code>qSIP2</code> knows how to calculate atom fraction
values from. This is currently limited to 12C/13C, 14N/15N and 16O/18O.
There are some “non-isotopic” names allowed as well for source material
that might be unfractionated. These additional options are “bulk”,
“unfractionated”, “T0”, “time0”, “Time0”, and are added as exceptions in
the <code><a href="../reference/validate_isotopes.html">validate_isotopes()</a></code> helper function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># artificially doubling the rows will give an error from duplicate source_mat_ids</span></span>
<span><span class="va">example_source_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">example_source_df</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/qsip_source_data.html">qsip_source_data</a></span><span class="op">(</span></span>
<span>    isotope <span class="op">=</span> <span class="st">"Isotope"</span>,</span>
<span>    isotopolog <span class="op">=</span> <span class="st">"isotopolog"</span>,</span>
<span>    source_mat_id <span class="op">=</span> <span class="st">"source"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Error: some source_mat_ids are duplicated</span></span></code></pre></div>
<p>One benefit of the validation steps being embedded in the object
itself is that these validations are automatically run when the object
is modified. This makes it impossible to modify the data later to an
invalid object, e.g. changing an isotope to an invalid choice.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">source_object</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">isotope</span> <span class="op">&lt;-</span> <span class="st">"13G"</span></span>
<span><span class="co">#&gt; invalid isotope found: 13G</span></span>
<span><span class="co">#&gt; Error: Please fix the isotope names and try again</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="misip">MISIP<a class="anchor" aria-label="anchor" href="#misip"></a>
</h2>
<p>While qSIP standards are part of the MISIP<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://www.biorxiv.org/content/10.1101/2023.07.13.548835v1" class="external-link uri"&gt;https://www.biorxiv.org/content/10.1101/2023.07.13.548835v1&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> standards, the
<code>qSIP2</code> package is a little less stringent. This means your
valid <code>qSIP2</code> object might not be valid for a MISIP
submission. At the source data level this is primarily through the
difference between how the <code>isotope</code> data is coded, plus the
addition of another <code>isotopolog_label</code> column.</p>
<p><code>qSIP2</code> has functions to convert between these two types.
<code>add_isotoplog_label()</code> makes a MISIP version of the source
data, and <code><a href="../reference/remove_isotopolog_label.html">remove_isotopolog_label()</a></code> converts it back to a
<code>qSIP2</code> compatible version. Two things are changed when
running <code>add_isotoplog_label()</code> - 1) the
<code>isotopolog_label</code> column is added and is populated with
either “isotopically labeled” or “natural abundance” for heavy and light
isotopes, respectively, and 2) the <code>isotope</code> column gets
modified to be only the heavy isotope (e.g. all “12C” entries become
“13C”).</p>
<div class="alert alert-primary">
Note, these functions are run on the source dataframe rather than on the
<code>qsip_source_data</code> object.
</div>
<div class="section level3">
<h3 id="adding-the-isotopolog_label-column">Adding the <code>isotopolog_label</code> column<a class="anchor" aria-label="anchor" href="#adding-the-isotopolog_label-column"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_source_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_isotopolog_label.html">add_isotopolog_label</a></span><span class="op">(</span>isotope <span class="op">=</span> <span class="st">"Isotope"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>A ’MISIPified version of
<code>example_source_df</code>
</caption>
<colgroup>
<col width="8%">
<col width="22%">
<col width="11%">
<col width="9%">
<col width="24%">
<col width="10%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">source</th>
<th align="right">total_copies_per_g</th>
<th align="right">total_dna</th>
<th align="left">isotope</th>
<th align="left">isotopolog_label</th>
<th align="left">Moisture</th>
<th align="left">isotopolog</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">S151</td>
<td align="right">95774992</td>
<td align="right">182.16852</td>
<td align="left">13C</td>
<td align="left">natural abundance</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S178</td>
<td align="right">62964478</td>
<td align="right">73.89526</td>
<td align="left">13C</td>
<td align="left">isotopically labeled</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S200</td>
<td align="right">59426155</td>
<td align="right">71.19377</td>
<td align="left">13C</td>
<td align="left">isotopically labeled</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S201</td>
<td align="right">56379702</td>
<td align="right">73.78225</td>
<td align="left">13C</td>
<td align="left">isotopically labeled</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S150</td>
<td align="right">53528072</td>
<td align="right">109.01522</td>
<td align="left">13C</td>
<td align="left">natural abundance</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S180</td>
<td align="right">51720787</td>
<td align="right">81.36874</td>
<td align="left">13C</td>
<td align="left">isotopically labeled</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
</tbody>
</table>
<p>Now, the <code>Isotope</code> column has been renamed to
<code>isotope</code> to satisfy MISIP standards, and all values have
been replaced with the heavy isotope.</p>
<table class="table">
<caption>Count of <code>isotope</code> types in
<code>example_source_df_MISIP</code>
</caption>
<thead><tr class="header">
<th align="left">isotope</th>
<th align="right">n</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">13C</td>
<td align="right">15</td>
</tr></tbody>
</table>
<p>And the designation for whether the source material was the “light”
or “heavy” version of the isotope has now been transferred to the
<code>isotopolog_label</code> column.</p>
<table class="table">
<caption>Count of <code>isotopolog_label</code> types in
<code>example_source_df_MISIP</code>
</caption>
<thead><tr class="header">
<th align="left">isotopolog_label</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">isotopically labeled</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">natural abundance</td>
<td align="right">8</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="removing-the-isotopolog_label-column">Removing the <code>isotopolog_label</code> column<a class="anchor" aria-label="anchor" href="#removing-the-isotopolog_label-column"></a>
</h3>
<p>This change can be reverted with the
<code><a href="../reference/remove_isotopolog_label.html">remove_isotopolog_label()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_source_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_isotopolog_label.html">add_isotopolog_label</a></span><span class="op">(</span>isotope <span class="op">=</span> <span class="st">"Isotope"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/remove_isotopolog_label.html">remove_isotopolog_label</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<code>example_source_df_MISIP</code> converted back</caption>
<thead><tr class="header">
<th align="left">source</th>
<th align="right">total_copies_per_g</th>
<th align="right">total_dna</th>
<th align="left">isotope</th>
<th align="left">Moisture</th>
<th align="left">isotopolog</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">S149</td>
<td align="right">34838665</td>
<td align="right">74.46539</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S150</td>
<td align="right">53528072</td>
<td align="right">109.01522</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S151</td>
<td align="right">95774992</td>
<td align="right">182.16852</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S152</td>
<td align="right">9126192</td>
<td align="right">23.68963</td>
<td align="left">12C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S161</td>
<td align="right">41744046</td>
<td align="right">67.62552</td>
<td align="left">12C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S162</td>
<td align="right">49402713</td>
<td align="right">94.21217</td>
<td align="left">12C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S163</td>
<td align="right">47777726</td>
<td align="right">87.82524</td>
<td align="left">12C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S164</td>
<td align="right">48734282</td>
<td align="right">75.97274</td>
<td align="left">12C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S178</td>
<td align="right">62964478</td>
<td align="right">73.89526</td>
<td align="left">13C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S179</td>
<td align="right">49475460</td>
<td align="right">68.65182</td>
<td align="left">13C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S180</td>
<td align="right">51720787</td>
<td align="right">81.36874</td>
<td align="left">13C</td>
<td align="left">Normal</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S200</td>
<td align="right">59426155</td>
<td align="right">71.19377</td>
<td align="left">13C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S201</td>
<td align="right">56379702</td>
<td align="right">73.78225</td>
<td align="left">13C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="even">
<td align="left">S202</td>
<td align="right">42562198</td>
<td align="right">108.11436</td>
<td align="left">13C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
<tr class="odd">
<td align="left">S203</td>
<td align="right">49914369</td>
<td align="right">80.48608</td>
<td align="left">13C</td>
<td align="left">Drought</td>
<td align="left">glucose</td>
</tr>
</tbody>
</table>
<p>Note, the original is not <em>exactly</em> preserved as the original
<code>Isotope</code> column has the MISIP standard <code>isotope</code>
name retained.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeff Kimbrel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
